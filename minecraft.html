<!-- minecraft.html -->
<script type="text/html" data-template-name="minecraft-server-config">
    <div class="form-row">
        <label for="node-config-input-host"><i class="fa fa-globe"></i> Host</label>
        <input type="text" id="node-config-input-host" placeholder="localhost">
    </div>
    <div class="form-row">
        <label for="node-config-input-rconPort"><i class="fa fa-random"></i> RCON Port</label>
        <input type="text" id="node-config-input-rconPort" placeholder="25575">
    </div>
    <div class="form-row">
        <label for="node-config-input-rconPassword"><i class="fa fa-lock"></i> RCON Password</label>
        <input type="password" id="node-config-input-rconPassword">
    </div>
</script>

<script type="text/html" data-template-name="minecraft-rcon">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-input-server"><i class="fa fa-server"></i> Server</label>
        <input type="text" id="node-input-server">
    </div>
    <div class="form-row">
        <label for="node-input-command"><i class="fa fa-terminal"></i> Default Command</label>
        <input type="text" id="node-input-command" placeholder="list">
    </div>
</script>

<script type="text/html" data-template-name="minecraft-status">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-input-server"><i class="fa fa-server"></i> Server</label>
        <input type="text" id="node-input-server">
    </div>
</script>

<!-- Player Info Node -->
<script type="text/html" data-template-name="minecraft-player-info">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-input-server"><i class="fa fa-server"></i> Server</label>
        <input type="text" id="node-input-server">
    </div>
    <div class="form-row">
        <label for="node-input-infoType"><i class="fa fa-info"></i> Info Type</label>
        <select id="node-input-infoType">
            <option value="health">Health</option>
            <option value="position">Position</option>
            <option value="inventory">Inventory</option>
            <option value="experience">Experience</option>
            <option value="gamemode">Game Mode</option>
            <option value="food">Food Level</option>
            <option value="effects">Active Effects</option>
            <option value="score">Scoreboard</option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-player"><i class="fa fa-user"></i> Default Player</label>
        <input type="text" id="node-input-player" placeholder="@p">
    </div>
</script>

<!-- Block Management Node -->
<script type="text/html" data-template-name="minecraft-block">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-input-server"><i class="fa fa-server"></i> Server</label>
        <input type="text" id="node-input-server">
    </div>
    <div class="form-row">
        <label for="node-input-action"><i class="fa fa-cube"></i> Action</label>
        <select id="node-input-action">
            <option value="set">Set Block</option>
            <option value="fill">Fill Area</option>
            <option value="clone">Clone Area</option>
            <option value="info">Get Block Info</option>
        </select>
    </div>
</script>

<!-- Entity Management Node -->
<script type="text/html" data-template-name="minecraft-entity">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-input-server"><i class="fa fa-server"></i> Server</label>
        <input type="text" id="node-input-server">
    </div>
    <div class="form-row">
        <label for="node-input-action"><i class="fa fa-bug"></i> Action</label>
        <select id="node-input-action">
            <option value="spawn">Spawn Entity</option>
            <option value="kill">Kill Entity</option>
            <option value="count">Count Entities</option>
            <option value="info">Get Entity Info</option>
            <option value="modify">Modify Entity</option>
        </select>
    </div>
</script>

<script type="text/javascript">
    // Add to existing registrations

    RED.nodes.registerType('minecraft-player-info', {
        category: 'minecraft',
        color: '#a6bbcf',
        defaults: {
            name: { value: "" },
            server: { type: "minecraft-server-config", required: true },
            infoType: { value: "health" },
            player: { value: "@p" }
        },
        inputs: 1,
        outputs: 1,
        icon: "info.png",
        label: function() {
            return this.name || "player info";
        },
        paletteLabel: "player info"
    });

    RED.nodes.registerType('minecraft-block', {
        category: 'minecraft',
        color: '#a6bbcf',
        defaults: {
            name: { value: "" },
            server: { type: "minecraft-server-config", required: true },
            action: { value: "set" }
        },
        inputs: 1,
        outputs: 1,
        icon: "cube.png",
        label: function() {
            return this.name || "block";
        },
        paletteLabel: "block"
    });

    RED.nodes.registerType('minecraft-entity', {
        category: 'minecraft',
        color: '#a6bbcf',
        defaults: {
            name: { value: "" },
            server: { type: "minecraft-server-config", required: true },
            action: { value: "spawn" }
        },
        inputs: 1,
        outputs: 1,
        icon: "bug.png",
        label: function() {
            return this.name || "entity";
        },
        paletteLabel: "entity"
    });
</script>

<!-- New Player Management template -->
<script type="text/html" data-template-name="minecraft-player">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-input-server"><i class="fa fa-server"></i> Server</label>
        <input type="text" id="node-input-server">
    </div>
    <div class="form-row">
        <label for="node-input-action"><i class="fa fa-tasks"></i> Action</label>
        <select id="node-input-action">
            <option value="kick">Kick</option>
            <option value="ban">Ban</option>
            <option value="pardon">Pardon</option>
            <option value="gamemode">Change Gamemode</option>
            <option value="tp">Teleport</option>
            <option value="give">Give Item</option>
            <option value="clear">Clear Inventory</option>
            <option value="kill">Kill</option>
            <option value="xp">Give XP</option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-player"><i class="fa fa-user"></i> Default Player</label>
        <input type="text" id="node-input-player" placeholder="@p">
    </div>
    <div class="form-row">
        <label for="node-input-gamemode"><i class="fa fa-gamepad"></i> Default Gamemode</label>
        <select id="node-input-gamemode">
            <option value="survival">Survival</option>
            <option value="creative">Creative</option>
            <option value="adventure">Adventure</option>
            <option value="spectator">Spectator</option>
        </select>
    </div>
</script>

<!-- New World Management template -->
<script type="text/html" data-template-name="minecraft-world">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-input-server"><i class="fa fa-server"></i> Server</label>
        <input type="text" id="node-input-server">
    </div>
    <div class="form-row">
        <label for="node-input-action"><i class="fa fa-tasks"></i> Action</label>
        <select id="node-input-action">
            <option value="time">Set Time</option>
            <option value="weather">Set Weather</option>
            <option value="difficulty">Set Difficulty</option>
            <option value="gamerule">Set Gamerule</option>
            <option value="worldborder">Set World Border</option>
            <option value="setworldspawn">Set World Spawn</option>
        </select>
    </div>
</script>

<!-- New Server Management template -->
<script type="text/html" data-template-name="minecraft-server">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-input-server"><i class="fa fa-server"></i> Server</label>
        <input type="text" id="node-input-server">
    </div>
    <div class="form-row">
        <label for="node-input-action"><i class="fa fa-tasks"></i> Action</label>
        <select id="node-input-action">
            <option value="save-all">Save World</option>
            <option value="save-off">Disable Saving</option>
            <option value="save-on">Enable Saving</option>
            <option value="stop">Stop Server</option>
            <option value="whitelist">Manage Whitelist</option>
            <option value="op">Op Player</option>
            <option value="deop">Deop Player</option>
            <option value="broadcast">Broadcast Message</option>
        </select>
    </div>
</script>

<script type="text/javascript">
   RED.nodes.registerType('minecraft-server-config', {
        category: 'config',
        defaults: {
            host: { value: "localhost", required: true },
            rconPort: { value: 25575, required: true, validate: RED.validators.number() },
            rconPassword: { value: "", required: true }
        },
        label: function() {
            return this.host + ":" + this.rconPort;
        }
    });

    RED.nodes.registerType('minecraft-rcon', {
        category: 'minecraft',
        color: '#a6bbcf',
        defaults: {
            name: { value: "" },
            server: { type: "minecraft-server-config", required: true },
            command: { value: "" }
        },
        inputs: 1,
        outputs: 1,
        icon: "file.png",
        label: function() {
            return this.name || "minecraft rcon";
        }
    });

    RED.nodes.registerType('minecraft-status', {
        category: 'minecraft',
        color: '#a6bbcf',
        defaults: {
            name: { value: "" },
            server: { type: "minecraft-server-config", required: true }
        },
        inputs: 1,
        outputs: 1,
        icon: "file.png",
        label: function() {
            return this.name || "minecraft status";
        }
    });

    // New Player Management registration
    RED.nodes.registerType('minecraft-player', {
        category: 'minecraft',
        color: '#a6bbcf',
        defaults: {
            name: { value: "" },
            server: { type: "minecraft-server-config", required: true },
            action: { value: "kick" },
            player: { value: "@p" },
            gamemode: { value: "survival" }
        },
        inputs: 1,
        outputs: 1,
        icon: "user.png",
        label: function() {
            return this.name || "minecraft player";
        },
        paletteLabel: "player"
    });

    // New World Management registration
    RED.nodes.registerType('minecraft-world', {
        category: 'minecraft',
        color: '#a6bbcf',
        defaults: {
            name: { value: "" },
            server: { type: "minecraft-server-config", required: true },
            action: { value: "time" }
        },
        inputs: 1,
        outputs: 1,
        icon: "world.png",
        label: function() {
            return this.name || "minecraft world";
        },
        paletteLabel: "world"
    });

    // New Server Management registration
    RED.nodes.registerType('minecraft-server', {
        category: 'minecraft',
        color: '#a6bbcf',
        defaults: {
            name: { value: "" },
            server: { type: "minecraft-server-config", required: true },
            action: { value: "save-all" }
        },
        inputs: 1,
        outputs: 1,
        icon: "server.png",
        label: function() {
            return this.name || "minecraft server";
        },
        paletteLabel: "server"
    });
</script>

<!-- RCON Command Node Help -->
<script type="text/html" data-help-name="minecraft-rcon">
    <p>Sends RCON commands to a Minecraft server.</p>
    
    <h3>Inputs</h3>
    <dl class="message-properties">
        <dt>payload <span class="property-type">string</span></dt>
        <dd>The Minecraft command to execute (e.g., "time set day")</dd>
    </dl>

    <h3>Outputs</h3>
    <dl class="message-properties">
        <dt>payload <span class="property-type">string</span></dt>
        <dd>The response from the server</dd>
    </dl>

    <h3>Details</h3>
    <p>This node allows you to send any valid Minecraft command to the server. Examples:</p>
    <ul>
        <li><code>time set day</code> - Sets time to day</li>
        <li><code>weather clear</code> - Sets weather to clear</li>
        <li><code>list</code> - Lists online players</li>
    </ul>
</script>

<!-- Status Node Help -->
<script type="text/html" data-help-name="minecraft-status">
    <p>Gets the current status of the Minecraft server.</p>

    <h3>Outputs</h3>
    <dl class="message-properties">
        <dt>payload <span class="property-type">object</span></dt>
        <dd>
            <ul>
                <li><b>online</b>: Number of players online</li>
                <li><b>max</b>: Maximum player capacity</li>
                <li><b>version</b>: Server version</li>
                <li><b>players</b>: Array of online players</li>
            </ul>
        </dd>
    </dl>

    <h3>Example Flow</h3>
    <pre>
[{"id":"status1","type":"minecraft-status"},{"id":"debug1","type":"debug"}]
    </pre>
</script>

<!-- Player Info Node Help -->
<script type="text/html" data-help-name="minecraft-player-info">
    <p>Retrieves specific information about a player.</p>

    <h3>Properties</h3>
    <dl class="message-properties">
        <dt>Info Type <span class="property-type">select</span></dt>
        <dd>Type of information to retrieve:
            <ul>
                <li><b>health</b>: Player's health points</li>
                <li><b>position</b>: Player's coordinates</li>
                <li><b>inventory</b>: Inventory contents</li>
                <li><b>experience</b>: XP level</li>
                <li><b>gamemode</b>: Current game mode</li>
                <li><b>food</b>: Food level</li>
                <li><b>effects</b>: Active potion effects</li>
            </ul>
        </dd>
    </dl>

    <h3>Inputs</h3>
    <dl class="message-properties">
        <dt>player <span class="property-type">string</span></dt>
        <dd>Player name or selector (e.g., "Steve" or "@p")</dd>
        <dt>infoType <span class="property-type">string</span></dt>
        <dd>Override the configured info type</dd>
    </dl>

    <h3>Outputs</h3>
    <dl class="message-properties">
        <dt>payload <span class="property-type">object</span></dt>
        <dd>
            <ul>
                <li><b>raw</b>: Raw server response</li>
                <li><b>value</b>: Parsed value</li>
                <li><b>player</b>: Player queried</li>
                <li><b>type</b>: Info type queried</li>
            </ul>
        </dd>
    </dl>
</script>

<!-- Block Node Help -->
<script type="text/html" data-help-name="minecraft-block">
    <p>Manages blocks in the Minecraft world.</p>

    <h3>Properties</h3>
    <dl class="message-properties">
        <dt>Action <span class="property-type">select</span></dt>
        <dd>
            <ul>
                <li><b>set</b>: Place a single block</li>
                <li><b>fill</b>: Fill an area with blocks</li>
                <li><b>clone</b>: Copy blocks from one area to another</li>
                <li><b>info</b>: Get block information</li>
            </ul>
        </dd>
    </dl>

    <h3>Inputs</h3>
    <dl class="message-properties">
        <dt>action <span class="property-type">string</span></dt>
        <dd>Override the configured action</dd>
        <dt>coordinates <span class="property-type">string</span></dt>
        <dd>Block coordinates (e.g., "0 64 0")</dd>
        <dt>block <span class="property-type">string</span></dt>
        <dd>Block type (e.g., "stone")</dd>
        <dt>endCoordinates <span class="property-type">string</span></dt>
        <dd>End coordinates for fill/clone</dd>
    </dl>

    <h3>Examples</h3>
    <pre>
// Set a block
msg.action = "set";
msg.coordinates = "0 64 0";
msg.block = "stone";

// Fill area
msg.action = "fill";
msg.coordinates = "0 64 0";
msg.endCoordinates = "10 64 10";
msg.block = "grass_block";
    </pre>
</script>

<!-- Entity Node Help -->
<script type="text/html" data-help-name="minecraft-entity">
    <p>Manages entities in the Minecraft world.</p>

    <h3>Properties</h3>
    <dl class="message-properties">
        <dt>Action <span class="property-type">select</span></dt>
        <dd>
            <ul>
                <li><b>spawn</b>: Create new entity</li>
                <li><b>kill</b>: Remove entities</li>
                <li><b>count</b>: Count entities</li>
                <li><b>info</b>: Get entity data</li>
                <li><b>modify</b>: Modify entity properties</li>
            </ul>
        </dd>
    </dl>

    <h3>Inputs</h3>
    <dl class="message-properties">
        <dt>action <span class="property-type">string</span></dt>
        <dd>Override the configured action</dd>
        <dt>entity <span class="property-type">string</span></dt>
        <dd>Entity type (e.g., "zombie")</dd>
        <dt>coordinates <span class="property-type">string</span></dt>
        <dd>Spawn coordinates</dd>
        <dt>nbt <span class="property-type">string</span></dt>
        <dd>Entity NBT data</dd>
    </dl>

    <h3>Examples</h3>
    <pre>
// Spawn a charged creeper
msg.action = "spawn";
msg.entity = "creeper";
msg.coordinates = "~ ~2 ~";
msg.nbt = "{powered:1}";

// Kill all zombies
msg.action = "kill";
msg.selector = "@e[type=zombie]";
    </pre>
</script>

<!-- World Management Node Help -->
<script type="text/html" data-help-name="minecraft-world">
    <p>Controls world settings and environment.</p>

    <h3>Properties</h3>
    <dl class="message-properties">
        <dt>Action <span class="property-type">select</span></dt>
        <dd>
            <ul>
                <li><b>time</b>: Set world time</li>
                <li><b>weather</b>: Change weather</li>
                <li><b>difficulty</b>: Set game difficulty</li>
                <li><b>gamerule</b>: Modify game rules</li>
            </ul>
        </dd>
    </dl>

    <h3>Inputs</h3>
    <dl class="message-properties">
        <dt>action <span class="property-type">string</span></dt>
        <dd>Override the configured action</dd>
        <dt>time <span class="property-type">string</span></dt>
        <dd>Time setting (day, night, etc.)</dd>
        <dt>weather <span class="property-type">string</span></dt>
        <dd>Weather type (clear, rain, thunder)</dd>
    </dl>

    <h3>Examples</h3>
    <pre>
// Set time to day
msg.action = "time";
msg.time = "day";

// Make it rain
msg.action = "weather";
msg.weather = "rain";
    </pre>
</script>